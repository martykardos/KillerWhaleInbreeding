This repository contains code used for data analysis and figures in the following paper. 

Inbreeding depression explains killer whale population dynamics

Marty Kardos1*, Yaolei Zhang2,4*, Kim M. Parsons1*, Yunga A2*, Hui Kang3, Xun Xu4, Xin Liu4, Craig O. Matkin5, Peijun Zhang3, Eric J. Ward1, M. Bradley Hanson1, Candice Emmons1, Michael J. Ford1†, Guangyi Fan2,4,6†, Songhai Li3, 7†
	
1 Northwest Fisheries Science Center, National Marine Fisheries Service, National Oceanic and Atmospheric Administration; Seattle, WA, USA

2BGI-Qingdao, BGI-Shenzhen; Qingdao, 266555, China.

3Marine Mammal and Marine Bioacoustics Laboratory, Institute of Deep-sea Science and Engineering, Chinese Academy of Sciences; Sanya, 572000, China.

4BGI-Shenzhen; Shenzhen 518083, China.

5North Gulf Oceanic Society; Homer, AK, USA.

6State Key Laboratory of Agricultural Genomics, BGI-Shenzhen; Shenzhen 518083, China.

7Center for Ocean Mega-Science, Chinese Academy of Sciences, Qingdao, 266071, China

*These authors contributed equally and are identified as joint first authors.

†Corresponding authors: Songhai Li (lish@idsse.ac.cn), Michael Ford (mike.ford@noaa.gov) and Guangyi Fan (fanguangyi@genomics.cn)


There are several folders that contain code for different analyses:

VariantEffectPredictor: variant effect prediction for analysis of genetic loads

RXY: Analysis of relative genetic loads

ROH: Runs of homozygosity

recombinationRate: Using the R package FastEPRR to estimate recombination rate across the killer whale genome

populationProjections: Individidual-based simulations of futureu population dynamics

SRKWIsolationTime: estimating expected isolation time for the Southern Resident Killer Whale population

Admixture: Analysis of admixture across North Pacific killer whale populations

Genome_assembly_and_annotation: Assembly and annotation of the killer whale genome

NJtree: Neighbor-joining treee for 147 killer whale genomes

PCA: Principle component analysis of 147 killer whale genomes

SNP_calling: variant calling in killer whale genomes

NeEstimator: linkage disequilibrium based analysis of contemporary effective population size

GONE: linkage disequilibrium based analysis of recent (back to 150 generations ago) changes effective population size

FigureCode: Code used to make figures

quantPop_0.3.9.tar.gz is an R package used in several analyses

demog_models_code contains the code used in the models of fitness components (survival/fecundity) as a function of inbreeding, sex, age, and year
